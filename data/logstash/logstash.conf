input {
    jdbc {
        jdbc_driver_library => "/connector/connector.jar"
        jdbc_driver_class => "com.mysql.jdbc.Driver"
        jdbc_connection_string => "jdbc:mysql://mysql:3306/qa"
        jdbc_user => "root"
        jdbc_password => "admin"
        jdbc_validate_connection => true
        statement => "SELECT * from qa.Posts WHERE PostTypeId = 1"
    }
}

filter {
    jdbc_streaming {
        jdbc_driver_library => "/connector/connector.jar"
        jdbc_driver_class => "com.mysql.jdbc.Driver"
        jdbc_connection_string => "jdbc:mysql://mysql:3306/qa"
        jdbc_user => "root"
        jdbc_password => "admin"
        jdbc_validate_connection => true
        statement => "select * from qa.Posts WHERE ParentId = :code ORDER BY Score LIMIT 5"
        parameters => { "code" => "id"}
        target => "answers"
    }
}

output {
    elasticsearch {
    	hosts => "elasticsearch:9200"
        index => "posts"
    }
}

view_count = @ViewCount,
post_type_id = @PostTypeId,
parent_id = @ParentId;
